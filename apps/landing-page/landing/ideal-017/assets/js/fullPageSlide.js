$(function(){var e=function(){var e=$("#bx-wrapper"),n=e.find("div.bx-container"),i=n.children("img"),t=i.length,a=e.find("div.bx-thumbs > a").hide(),s=e.find("h2:first"),d=0,c={speed:500,variation:1,blurFactor:5},r=!1,o=Modernizr.canvas,h=function(){var e=0;i.each(function(n){var i=$(this);$('<img data-pos="'+i.index()+'"/>').load(function(){var n=$(this),i=u(n.attr("src")),s=n.data("pos");$.when(x(s,i)).done(function(){++e,e===t&&(a.fadeIn(),f(),v())})}).attr("src",i.attr("src"))})},x=function(e,n){return!0},u=function(e){var n=new Image;n.src=e;var i,t,a=$(window),s=a.width(),d=a.height(),c=d/s,r=n.width,o=n.height,h=o/r;return c>h?(t=d,i=d/h):(t=s*h,i=s),{width:i,height:t,left:(s-i)/2,top:(d-t)/2}},v=function(){$(window).on("resize.BlurBGImage",function(e){return f(),!1}),a.on("click.BlurBGImage",function(e){var n=$(this),i=n.index();return 7!=i?(r||i===d||(a.removeClass("bx-thumbs-current"),n.addClass("bx-thumbs-current"),r=!0,b(i)),!1):void 0})},f=function(){i.each(function(e){var i=$(this),t=(u(i.attr("src")),n.children("canvas[data-pos="+i.index()+"]")),a={height:"100%"};i.css(a),o&&t.css(a),e===d&&i.show()})},b=function(e){var t=i.eq(d);$bxCanvas=n.children("canvas[data-pos="+t.index()+"]"),$bxNextImage=i.eq(e),$bxNextCanvas=n.children("canvas[data-pos="+$bxNextImage.index()+"]"),o?($.when(s.fadeOut()).done(function(){s.text($bxNextImage.attr("title"))}),$bxCanvas.css("z-index",100).css("visibility","visible"),$.when(t.fadeOut(c.speed)).done(function(){switch(c.variation){case 1:s.fadeIn(c.speed),$.when($bxNextImage.fadeIn(c.speed)).done(function(){$bxCanvas.css("z-index",1).css("visibility","hidden"),d=e,$bxNextCanvas.css("visibility","hidden"),r=!1});break;case 2:$bxNextCanvas.css("visibility","visible"),$.when($bxCanvas.fadeOut(1.5*c.speed)).done(function(){$(this).css({"z-index":1,visibility:"hidden"}).show(),s.fadeIn(c.speed),$.when($bxNextImage.fadeIn(c.speed)).done(function(){d=e,$bxNextCanvas.css("visibility","hidden"),r=!1})})}})):(s.hide().text($bxNextImage.attr("title")).fadeIn(c.speed),$.when($bxNextImage.css("z-index",102).fadeIn(c.speed)).done(function(){d=e,t.hide(),$(this).css("z-index",101),r=!1}))};return{init:h}}();e.init()});